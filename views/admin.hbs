<!DOCTYPE html>
<html lang="pt">
  <head>
    <meta charset="UTF-8">
    <title>{{titulo}}</title>
    <link rel="stylesheet" href="/css/styles.css">
  </head>

  <body>
    <header class="topbar">
      <h1>Painel de Administração</h1>
      <nav>
        <a href="/">Início</a>
        <a href="/lista">Lista Pública</a>
        <a href="/admin/logout">Logout</a>
      </nav>
    </header>

    <main class="conteudo">
      <h2>Inscrições (todas)</h2>

      <p>
        <a href="/admin/export-csv" class="btn-secundario">
          Download CSV para Excel
        </a>
      </p>

      <table class="tabela-inscritos">
        <thead>
          <tr>
            <th>ID</th>
            <th>Nome</th>
            <th>Email</th>
            <th>Telefone</th>
            <th>Distrito</th>
            <th>Concelho</th>
            <th>Menu</th>
            <th>Cancelado?</th>
          </tr>
        </thead>

        <tbody>
          {{#each inscricoes}}
            <tr>
              <td>{{this.id}}</td>
              <td>{{this.nome}}</td>
              <td>{{this.email}}</td>
              <td>{{this.telefone}}</td>
              <td>{{this.distrito}}</td>
              <td>{{this.concelho}}</td>
              <td>{{this.menu}}</td>
              <td>
                {{#if this.cancelado}}
                  Sim
                {{else}}
                  Não
                {{/if}}
              </td>
            </tr>
          {{/each}}

          {{!-- Mensagens de feedback --}}
          {{#if msg}}
            <p class="ok">{{msg}}</p>
          {{/if}}

          {{#if erro}}
            <p class="erro">{{erro}}</p>
          {{/if}}

          <section class="secao-contacto">
            <h2>Enviar email de recordatório</h2>

            <p>
              Este botão envia um email de recordatório para
              <strong>todos os inscritos ativos</strong>,
              a lembrar a data e hora do almoço.
            </p>

            <form method="POST" action="/admin/enviar-recordatorio">
              <label for="mensagemExtra">
                Mensagem extra para incluir no email (opcional):
              </label>

              <textarea
                id="mensagemExtra"
                name="mensagemExtra"
                rows="4"
                style="width:100%;"
              ></textarea>

              <button type="submit" class="btn-principal"
                      onclick="return confirm('Tens a certeza que queres enviar o recordatório para todos os inscritos ativos?');">
                Enviar recordatório para todos os inscritos
              </button>
              
            </form>
          </section>
        </tbody>
      </table>
    </main>
  </body>
</html>